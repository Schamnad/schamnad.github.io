---
layout: "post"
title: "GSOC 2016"
date: "2016-08-21 12:43"
---
![alt text](https://developers.google.com/open-source/gsoc/resources/downloads/GSoC-icon-192.png "Gsoc2016")

**Integration of cclib with Avogadro 2**

### A little Introduction
I applied for Google Summer of code in the final semester of my undergraduate studies. During my undergraduate studies I concentrated on the field of Computational Chemistry, where I used Avogadro quite a bit. Avogadro is an advanced molecular editor, used for various research purposes.

I applied for GSOC-2016 under the Open Chemistry organization because I had extensively utilized the applications provided by them and I wanted to give back to the community. The entire summer has been a very fruitful period where I have interacted with my mentors on a daily basis. I have also indicated to them that I wish to continue contributing to the organization.


cclib is an open source library, written in Python, for parsing and interpreting the results of computational chemistry simulations. It provides a consistent interface to extract (parse) data from the output files generated by various cheminformatic program packages like Gaussian, Gamess, Jaguar, MolPro, Orca etc.  

Avogadro-2 is an advanced molecular editor which provides flexible rendering, and a powerful plugin architecture designed for use in computational chemistry, molecular modeling, and other related areas. Avogadro-2 is part of the OpenChemistry suite of applications.

This project proposed to integrate the cclib data parsing library with Avogadro-2 using the Chemical JSON format. Chemical JSON is a standard JSON format being developed by the OpenChemistry group across different applications.

### Relevant Links:

1. Organization :
 [Open Chemistry](http://www.openchemistry.org/)
2. Project Title : Avogadro-2: Integration of cclib data parser using Chemical JSON ([Abstract](https://summerofcode.withgoogle.com/projects/#6520053793030144))
3. Mentors:
    - Karol Langner ([github](https://github.com/langner), [LinkedIn](https://www.linkedin.com/in/karollangner))
    - Adam Tenderholt ([github](https://github.com/ATenderholt), [LinkedIn](https://www.linkedin.com/in/tenderholt))

4. Repositories contributed to:
    - [cclib](https://github.com/cclib/cclib/)
    - [OpenChemistry : Avogadrolibs](https://github.com/OpenChemistry/avogadrolibs)

5. Commits authored:
    - [cclib - master](https://github.com/cclib/cclib/commits/master?author=Schamnad)
    - [avogadrolibs - fork](https://github.com/Schamnad/avogadrolibs/commits/schamnad_GSOC16?author=schamnad)


6. Pull requests:
  - cclib
        - [Implementation of the CJSON writer](https://github.com/cclib/cclib/pull/279) **[MERGED]**
        - [Movement of a few attributes in the CJSON format](https://github.com/cclib/cclib/pull/305) **[MERGED]**
        - [CJSON Reader - Removal of cjsonHolder DS](https://github.com/cclib/cclib/pull/308) **[MERGED]**
        - [Add anharmonic freq. and constrained scan calc. files to expand test](https://github.com/cclib/cclib/pull/281) **[MERGED]**
        - [Replace NaN's with null to form valid json files](https://github.com/cclib/cclib/pull/318) **[MERGED]**
  - Avogadrolibs
        - [cclib script](https://github.com/OpenChemistry/avogadrolibs/pull/106) _[UNDER REVIEW]_
        - [CJSON format](https://github.com/OpenChemistry/avogadrolibs/pull/104) _[UNDER REVIEW]_
        - [Visualize properties](https://github.com/OpenChemistry/avogadrolibs/pull/105) _[UNDER REVIEW]_


### Work accomplished:

#### Chemical JSON
The chemical JSON design was completed with the help of [Karol Langner](https://github.com/langner), [Adam Tenderholt](https://github.com/ATenderholt), [Geoffrey Hutchison](https://github.com/ghutchis) and [Marcus Hanwell](https://github.com/cryos). The design has been shared [here](https://docs.google.com/document/d/1_RYFXzhxHK525id0A930Pa1y38Ui2X5GgtAo68iE5Oc/edit?usp=sharing) on a public Google Doc.

The **56** different attributes that the cclib library can parse have been organized under the right object names (such as properties, atoms, vibrations, optimization etc). These attributes have also been given a more human readable Key name (for e.g: '_Anharmonicity constants_' for '_vibanharms_' attribute).

Using this design spec as a model, the [CJSON writer](https://github.com/cclib/cclib/blob/master/src/cclib/io/cjsonwriter.py) was implemented and merged with the cclib library. Users of cclib can use the CJSON writer in the following manner to generate a CJSON file from **any** computational chemistry output file which cclib supports.

On command line:

for the indented version: `ccwrite cjson output_file_name`

for the non indented version, a --terse flag is provided:
`ccwrite cjson --terse output_file_name`

An example input file is provided [here](https://raw.githubusercontent.com/Schamnad/schamnad.github.io/master/_includes/dvb_sp_un.out), and the generated CJSON files are available here:

- [Indented form](https://raw.githubusercontent.com/Schamnad/schamnad.github.io/master/_includes/dvb_sp_un-indented.cjson)
- [Terse form](https://raw.githubusercontent.com/Schamnad/schamnad.github.io/master/_includes/dvb_sp_un.cjson)

Similarly a [CJSON reader](https://github.com/cclib/cclib/blob/master/src/cclib/io/cjsonreader.py) was implemented and merged with the parent repository. Using the _cjsonreader_ a user can parse any of the 56 attributes that cclib supports by the following command:

`ccget --cjson <attribute_name> output_file_name`

#### Avogadro 2

The primary task in the integration was to develop a manner in which the computational output file provided by the user would be passed to cclib and the generated CJSON would be read by avogadro internals.

The cclib-avogadro interfacing [script](https://github.com/Schamnad/avogadrolibs/blob/cclibScript/avogadro/qtplugins/scriptfileformats/formatScripts/cclib/cclibScript.py) was written in the form of a formatScript (python). The generated CJSON was passed to a CJSON file format which previously existed. The [CJSON format](https://github.com/Schamnad/avogadrolibs/blob/schamnad_GSOC16/avogadro/io/cjsonformat.cpp) was extensively developed to parse and store the attributes that are available in the [CJSON](https://docs.google.com/document/d/1_RYFXzhxHK525id0A930Pa1y38Ui2X5GgtAo68iE5Oc/edit?usp=sharing). The data parsed from the CJSON file was stored in the internal Data structures of the [Molecule](https://github.com/Schamnad/avogadrolibs/blob/schamnad_GSOC16/avogadro/core/molecule.h) class.

From this stored data, the Molecular Properties dialog box was split into two :

  General Properties

 ![General Properties](https://raw.githubusercontent.com/Schamnad/schamnad.github.io/master/_includes/GeneralProperties.png)

 Energy Properties

 ![Energy Properties](https://raw.githubusercontent.com/Schamnad/schamnad.github.io/master/_includes/EnergyProperties.png)

### Future Tasks:

1. Integration of the CJSON Data structure within the cjsonwriter
2. On the cclib end, relevant test cases for the cjson writer and reader are pending
3. Migration of the Orbitals Widget from Avogadro-1 to Avogadro-2
4. Integration of cclib in the Open Chemistry super-build

### Personal Takeaway:

It's been a very hectic 5 months to say the least, I had a sync up session with both Karol and Adam on a daily basis. We used to meet at 9.15 p.m IST (8.45 a.m PST) where we would discuss what I did during the day and if I was stuck in any way.

I learnt new things about Python and C++ on a daily basis. The design aspect of the project was quite challenging and a lot of fun, hearing everyones opinion and understanding their thinking behind them helped me grow a lot.

On a formal note:
I would like to thank the following:

- The [Google Summer of Code](https://summerofcode.withgoogle.com) organisation, for this wonderful experience.
- [Open Chemistry](openchemistry.org), for accepting my project proposal and letting me embark on this fantastic adventure.
- My official mentors, Mr.Karol Langner, Mr. Adam Tenderholt, and my unofficial mentors, Marcus Hanwell and Dr. Geoffrey Hutchison, for being there to help me.
